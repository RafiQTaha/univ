(self.webpackChunk=self.webpackChunk||[]).push([[322],{2893:(e,a,r)=>{var t=r(9755);function n(e,a,r,t,n,s,o){try{var i=e[s](o),c=i.value}catch(e){return void r(e)}i.done?a(c):Promise.resolve(c).then(t,n)}function s(e){return function(){var a=this,r=arguments;return new Promise((function(t,s){var o=e.apply(a,r);function i(e){n(o,t,s,i,c,"next",e)}function c(e){n(o,t,s,i,c,"throw",e)}i(void 0)}))}}r(3076),r(4916),r(4765),r(9826),r(1539),r(2564),r(8674),t(document).ready((function(){var e=Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:function(e){e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),a=!1,r=t("#datables_facture").DataTable({lengthMenu:[[10,15,25,50,100,2e13],[10,15,25,50,100,"All"]],order:[[0,"desc"]],ajax:"/facture/factures/list",processing:!0,serverSide:!0,deferRender:!0,scrollX:!0,drawCallback:function(){t("body tr#"+a).addClass("active_databales")},language:{url:"//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/French.json"}});t("select").select2(),t("#etablissement").on("change",s(regeneratorRuntime.mark((function e(){var a,n,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t(this).val(),r.columns(1).search(""),n="",""==a){e.next=13;break}return t("#reglement")&&""!=t("#reglement").val()&&r.columns(2).search(t("#reglement").val()),""!=t("#organisme").val()&&r.columns(3).search(t("#organisme").val()),r.columns(0).search(a).draw(),e.next=9,axios.get("/api/formation/"+a);case 9:s=e.sent,n=s.data,e.next=16;break;case 13:r.columns(0).search(a).draw(),t("#reglement")&&""!=t("#reglement").val()&&r.columns(2).search(t("#reglement").val()),""!=t("#organisme").val()&&r.columns(3).search(t("#organisme").val());case 16:t("#formation").html(n).select2();case 17:case"end":return e.stop()}}),e,this)})))),t("#formation").on("change",s(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t(this).val(),r.columns().search(""),t("#reglement")&&""!=t("#reglement").val()&&r.columns(2).search(t("#reglement").val()),""!=t("#organisme").val()&&r.columns(3).search(t("#organisme").val()),"",""==a){e.next=13;break}return r.columns(1).search(a).draw(),e.next=9,axios.get("/api/promotion/"+a);case 9:n=e.sent,n.data,e.next=14;break;case 13:r.columns(0).search(t("#etablissement").val()).draw();case 14:case"end":return e.stop()}}),e,this)})))),t("#reglement").on("change",s(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t(this).val(),r.columns(2).search(a).draw();case 2:case"end":return e.stop()}}),e,this)})))),t("#organisme").on("change",s(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t(this).val(),r.columns(3).search(a).draw();case 2:case"end":return e.stop()}}),e,this)}))));var n=!1,o=function(){axios.get("/facture/factures/getMontant/"+a).then((function(e){n=null,t("#ajouter").removeClass("btn-primary").addClass("btn-secondary").attr("disabled",!1),"vide"!=e.data&&(n=12,t("#montant").val(e.data),t("#montant2").val(e.data),t("#ajouter").removeClass("btn-secondary").addClass("btn-primary").attr("disabled",!0))})).catch((function(e){console.log(e)}))},i=function(){var e=t("#facture i");e.removeClass("fa-money-bill-alt").addClass("fa-spinner fa-spin"),axios.get("/facture/factures/detaille_facture/"+a).then((function(a){0==a.data[0]?(t(".modal-facture #add_detaille").css("display","none"),t(".modal-facture #add").css("display","none"),t(".modal-facture #detaille_active").css("display","none")):(t(".modal-facture #add_detaille").css("display","block"),t(".modal-facture #add").css("display","flex"),t(".modal-facture #detaille_active").css("display","block")),t(".table_detaille_facture tbody").html(a.data[1]),e.removeClass("fa-spinner fa-spin").addClass("fa-money-bill-alt")})).catch((function(e){console.log(e)}))},c=function(){var e=s(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=6;break}return e.next=3,axios.get("/api/organisme/"+a);case 3:r=e.sent,response=r.data,t("#org").html(response).select2();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t("body").on("click","#datables_facture tbody tr",(function(e){e.preventDefault(),t(this).hasClass("active_databales")?(t(this).removeClass("active_databales"),a=null,n=null,t("#ajouter").removeClass("btn-primary").addClass("btn-secondary").attr("disabled",!1)):(t("#datables_facture tbody tr").removeClass("active_databales"),t(this).addClass("active_databales"),a=t(this).attr("id"),console.log(a),c(),o(),i(),a&&axios.get("/facture/factures/article_frais/"+a).then((function(e){t("#detail_facture_modal #frais").html(e.data).select2()})).catch((function(e){console.log(e)})))})),t("body").on("click","#facture",(function(r){r.preventDefault(),a?t("#detail_facture_modal").modal("show"):e.fire({icon:"error",title:"Veuillez selection une ligne!"})})),t("body").on("change",".modal-facture #frais",(function(e){e.preventDefault();var a=t(this).find(":selected").attr("data-id");""!=a&&t(".modal-facture #montantt").val(),t(".modal-facture #montantt").val(a)})),t("body").on("click","#add_detaille",function(){var e=s(regeneratorRuntime.mark((function e(n){var s,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),(s=t(this).find("i")).removeClass("fa-plus").addClass("fa-spinner fa-spin"),(c=new FormData).append("frais",t("#frais").val()),c.append("montant",t("#montantt").val()),c.append("ice",t("#ice").val()),t(".modal-facture .modal-body .alert").remove(),e.prev=9,e.next=12,axios.post("/facture/factures/add_detaille/"+a,c);case 12:e.sent,i(),t(".modal-facture .modal-body").prepend('<div class="alert alert-success">Facture Bien Ajouter</div>'),s.removeClass("fa-spinner fa-spin").addClass("fa-plus"),o(),r.ajax.reload(null,!1),e.next=25;break;case 20:e.prev=20,e.t0=e.catch(9),l=e.t0.response.data,t(".modal-facture .modal-body").prepend('<div class="alert alert-danger">'.concat(l,"</div>")),s.removeClass("fa-spinner fa-spin").addClass("fa-plus");case 25:setTimeout((function(){t(".modal-facture .modal-body .alert").remove()}),4e3);case 26:case"end":return e.stop()}}),e,this,[[9,20]])})));return function(a){return e.apply(this,arguments)}}()),t("body").on("click",".detaille_cloture",function(){var e=s(regeneratorRuntime.mark((function e(a){var n,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),(n=t(this).find("i")).removeClass("fa-window-close").addClass("fa-spinner fa-spin"),s=t(this).attr("id"),e.prev=4,e.next=7,axios.post("/facture/factures/cloture_detaille/"+s);case 7:e.sent,o(),i(),r.ajax.reload(null,!1),n.removeClass("fa-spinner fa-spin").addClass("fa-window-close"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),e.t0.response.data,n.removeClass("fa-spinner fa-spin").addClass("fa-window-close");case 18:case"end":return e.stop()}}),e,this,[[4,14]])})));return function(a){return e.apply(this,arguments)}}()),t("body").on("click","#ajouter",(function(r){r.preventDefault(),a?n?t("#ajouter_modal").modal("show"):e.fire({icon:"error",title:"Cette Facture N'a Aucun Detail!"}):e.fire({icon:"error",title:"Veuillez selection une ligne!"})})),t("body").on("submit",".new_facture-form",function(){var e=s(regeneratorRuntime.mark((function e(s){var i,c,l,u,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),i=t(this).serialize(),(c=t("#ajouter_modal .modal-body .alert")).remove(),(l=t(".new_facture-form .btn i")).removeClass("fa-check-circle").addClass("fa-spinner fa-spin"),e.prev=6,e.next=9,axios.post("/facture/factures/ajouter_reglement/"+a,i);case 9:u=e.sent,d=u.data,t("#ajouter_modal .modal-body").prepend('<div class="alert alert-success">reglement Bien Ajouter</div>'),t(this).trigger("reset"),o(),l.addClass("fa-check-circle").removeClass("fa-spinner fa-spin"),n=!1,r.ajax.reload(null,!1),window.open("/facture/factures/facture/"+a+"/"+d,"_blank"),e.next=27;break;case 20:e.prev=20,e.t0=e.catch(6),f=e.t0.response.data,console.log(e.t0,e.t0.response),c.remove(),t("#ajouter_modal .modal-body").prepend('<div class="alert alert-danger">'.concat(f,"</div>")),l.addClass("fa-check-circle").removeClass("fa-spinner fa-spin ");case 27:setTimeout((function(){t("#ajouter_modal .modal-body .alert").remove()}),4e3);case 28:case"end":return e.stop()}}),e,this,[[6,20]])})));return function(a){return e.apply(this,arguments)}}()),t("body").on("click","#modifier",function(){var r=s(regeneratorRuntime.mark((function r(n){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.preventDefault(),a){r.next=4;break}return e.fire({icon:"error",title:"Veuillez selection une ligne!"}),r.abrupt("return");case 4:t("#modifier_org-modal").modal("show");case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()),t("body").on("click","#modifier_org",function(){var e=s(regeneratorRuntime.mark((function e(n){var s,o,i,c,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),(s=t("#modifier_org-modal .modal-body .alert")).remove(),(o=t(".modal_modifier_org-facture .btn i")).removeClass("fa-check-circle").addClass("fa-spinner fa-spin"),(i=new FormData).append("organisme",t("#org").val()),e.prev=7,e.next=10,axios.post("/facture/factures/modifier_organisme_facture/"+a,i);case 10:c=e.sent,l=c.data,t("#modifier_org-modal .modal-body").prepend('<div class="alert alert-success">'.concat(l,"</div>")),o.addClass("fa-check-circle").removeClass("fa-spinner fa-spin"),r.ajax.reload(null,!1),t("#org").select2(),e.next=24;break;case 18:e.prev=18,e.t0=e.catch(7),u=e.t0.response.data,s.remove(),t("#modifier_org-modal .modal-body").prepend('<div class="alert alert-danger">'.concat(u,"</div>")),o.addClass("fa-check-circle").removeClass("fa-spinner fa-spin ");case 24:setTimeout((function(){t("#modifier_org-modal .modal-body .alert").remove()}),4e3);case 25:case"end":return e.stop()}}),e,null,[[7,18]])})));return function(a){return e.apply(this,arguments)}}()),t("body").on("click","#imprimer",function(){var r=s(regeneratorRuntime.mark((function r(t){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.preventDefault(),a){r.next=4;break}return e.fire({icon:"error",title:"Veuillez selection une ligne!"}),r.abrupt("return");case 4:window.open("/facture/factures/printfacture/"+a,"_blank");case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}))}},e=>{e.O(0,[755,29,515],(()=>{return a=2893,e(e.s=a);var a}));e.O()}]);