(self.webpackChunk=self.webpackChunk||[]).push([[7389],{9089:(e,r,a)=>{var n=a(9755);function t(e,r,a,n,t,s,i){try{var o=e[s](i),l=o.value}catch(e){return void a(e)}o.done?r(l):Promise.resolve(l).then(n,t)}function s(e){return function(){var r=this,a=arguments;return new Promise((function(n,s){var i=e.apply(r,a);function o(e){t(i,n,s,o,l,"next",e)}function l(e){t(i,n,s,o,l,"throw",e)}o(void 0)}))}}a(3076),a(4916),a(4765),a(2772),a(561),a(9826),a(1539),a(2564),a(8674),n(document).ready((function(){var e=Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:function(e){e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),r=!1,a=[],t=n("#datables_reglement").DataTable({lengthMenu:[[10,15,25,50,100,2e13],[10,15,25,50,100,"All"]],order:[[0,"desc"]],ajax:"/facture/reglements/list",processing:!0,serverSide:!0,deferRender:!0,scrollX:!0,drawCallback:function(){n("body tr#"+r).addClass("active_databales")},preDrawCallback:function(e){n.fn.DataTable.isDataTable("#datables_reglement")&&((e=n("#datables_reglement").DataTable().settings())[0].jqXHR&&e[0].jqXHR.abort())},language:datatablesFrench});n("select").select2(),n("#etablissement").on("change",s(regeneratorRuntime.mark((function e(){var r,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n(this).val(),t.columns(1).search(""),a="",""==r){e.next=13;break}return n("#paiement")&&""!=n("#paiement").val()&&t.columns(2).search(n("#paiement").val()),""!=n("#bordereaux").val()&&t.columns(3).search(n("#bordereaux").val()),t.columns(0).search(r).draw(),e.next=9,axios.get("/api/formation/"+r);case 9:s=e.sent,a=s.data,e.next=16;break;case 13:t.columns(0).search(r).draw(),n("#paiement")&&""!=n("#paiement").val()&&t.columns(2).search(n("#paiement").val()),""!=n("#bordereaux").val()&&t.columns(3).search(n("#bordereaux").val());case 16:n("#formation").html(a).select2();case 17:case"end":return e.stop()}}),e,this)})))),n("#formation").on("change",s(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n(this).val(),t.columns().search(""),""!=n("#paiement").val()&&t.columns(2).search(n("#paiement").val()),""!=n("#bordereaux").val()&&t.columns(3).search(n("#bordereaux").val()),"",""==r){e.next=13;break}return t.columns(1).search(r).draw(),e.next=9,axios.get("/api/promotion/"+r);case 9:a=e.sent,a.data,e.next=14;break;case 13:t.columns(0).search(n("#etablissement").val()).draw();case 14:case"end":return e.stop()}}),e,this)})))),n("#paiement").on("change",s(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n(this).val(),t.columns(2).search(r).draw();case 2:case"end":return e.stop()}}),e,this)})))),n("#bordereaux").on("change",s(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n(this).val(),t.columns(3).search(r).draw();case 2:case"end":return e.stop()}}),e,this)})))),n("body").on("dblclick","#datables_reglement tbody tr",(function(e){e.preventDefault(),n(this).hasClass("active_databales")?(n(this).removeClass("active_databales"),r=null):(n("#datables_reglement tbody tr").removeClass("active_databales"),n(this).addClass("active_databales"),r=n(this).attr("id"),function(){n("#modifier_org-modal .modal-body .alert").remove();var e=n("#modifier i");e.removeClass("fa-edit").addClass("fa-spinner fa-spin"),axios.get("/facture/reglements/getReglementInfos/"+r).then((function(r){e.removeClass("fa-spinner fa-spin").addClass("fa-edit"),console.log(r),n("#edit_modal .edit_reglement-form").html(r.data),n("#edit_modal .edit_reglement-form select").select2()})).catch((function(r){console.log(r),e.removeClass("fa-spinner fa-spin ").addClass("fa-edit")}))}()),console.log(r)})),n("body").on("click","#check",(function(){var e=n(this);if(console.log(e.attr("data-id")),e.is(":checked"))a.push(e.attr("data-id"));else{var r=a.indexOf(e.attr("data-id"));a.splice(r,1)}console.log(a)})),n("body").on("click","#imprimer",function(){var a=s(regeneratorRuntime.mark((function a(n){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n.preventDefault(),r){a.next=4;break}return e.fire({icon:"error",title:"Veuillez selection une ligne!"}),a.abrupt("return");case 4:window.open("/facture/reglements/reglementprint/"+r,"_blank");case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()),n("body").on("click","#borderaux",function(){var r=s(regeneratorRuntime.mark((function r(s){var i,o,l,c,u;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(s.preventDefault(),n("#modifier_org-modal .modal-body .alert").remove(),i=n("#borderaux i"),0!==a.length&&""!=n("#etablissement").val()&&""!=n("#formation").val()&&""!=n("#paiement").val()){r.next=7;break}return e.fire({icon:"error",title:"Merci de Choisir l'etablissement, la formation, mode de paiement et au moins une ligne, "}),r.abrupt("return");case 7:return i.removeClass("fa-folder").addClass("fa-spinner fa-spin"),(o=new FormData).append("ids_reglement",JSON.stringify(a)),r.prev=10,r.next=13,axios.post("/facture/reglements/borderaux/"+n("#formation").val()+"/"+n("#paiement").val(),o);case 13:l=r.sent,c=l.data,i.addClass("fa-folder").removeClass("fa-spinner fa-spin"),e.fire({icon:"success",title:"Borderaux Bien Genere"}),a.length=[],window.open("/facture/reglements/printborderaux/"+c,"_blank"),t.ajax.reload(null,!1),console.log(a),r.next=29;break;case 23:r.prev=23,r.t0=r.catch(10),u=r.t0.response.data,console.log(r.t0,r.t0.response),i.addClass("fa-folder").removeClass("fa-spinner fa-spin"),e.fire({icon:"error",title:u});case 29:case"end":return r.stop()}}),r,null,[[10,23]])})));return function(e){return r.apply(this,arguments)}}()),n("body").on("click","#imprimer_creance",function(){var e=s(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),window.open("/facture/reglements/creanceprint","_blank");case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),n("body").on("click","#annuler",(function(a){a.preventDefault(),r?n("#annuler_reglement_modal").modal("show"):e.fire({icon:"error",title:"Merci de choisir un reglement"})})),n("body").on("click","#Annuler_reglement",function(){var a=s(regeneratorRuntime.mark((function a(s){var i,o,l,c,u;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(s.preventDefault(),r){a.next=4;break}return e.fire({icon:"error",title:"Merci de choisir un reglement"}),a.abrupt("return");case 4:if(""!=n("#motif_annuler").find(":selected").val()){a.next=7;break}return e.fire({icon:"error",title:"Merci de Choisir Le Motif d'annulation"}),a.abrupt("return");case 7:if(1!=confirm("Vous voulez vraiment Annuler cette Reglement ?")){a.next=28;break}return(i=n("#Annuler_reglement i")).removeClass("fa-times-circle").addClass("fa-spinner fa-spin"),(o=new FormData).append("motif_annuler",n("#motif_annuler").val()),a.prev=13,a.next=16,axios.post("/facture/reglements/annuler_reglement/"+r,o);case 16:l=a.sent,c=l.data,e.fire({icon:"success",title:c}),t.ajax.reload(null,!1),i.addClass("fa-times-circle").removeClass("fa-spinner fa-spin"),a.next=28;break;case 23:a.prev=23,a.t0=a.catch(13),u=a.t0.response.data,e.fire({icon:"error",title:u}),i.addClass("fa-times-circle").removeClass("fa-spinner fa-spin");case 28:case"end":return a.stop()}}),a,null,[[13,23]])})));return function(e){return a.apply(this,arguments)}}()),n("body").on("click","#modifier",(function(a){a.preventDefault(),r?n("#edit_modal").modal("show"):e.fire({icon:"error",title:"Veuillez selection une ligne!"})})),n("body").on("submit",".edit_reglement-form",function(){var e=s(regeneratorRuntime.mark((function e(a){var s,i,o,l,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),s=n(this).serialize(),(i=n("#edit_modal .modal-body .alert")).remove(),(o=n(".edit_reglement-form .btn i")).removeClass("fa-check-circle").addClass("fa-spinner fa-spin"),e.prev=6,e.next=9,axios.post("/facture/reglements/modifier_reglement/"+r,s);case 9:l=e.sent,c=l.data,n("#edit_modal .modal-body").prepend('<div class="alert alert-success">'.concat(c,"</div>")),o.addClass("fa-check-circle").removeClass("fa-spinner fa-spin"),reglement=!1,t.ajax.reload(null,!1),window.open("/facture/reglements/reglementprint/"+r,"_blank"),e.next=25;break;case 18:e.prev=18,e.t0=e.catch(6),u=e.t0.response.data,console.log(e.t0,e.t0.response),i.remove(),n("#edit_modal .modal-body").prepend('<div class="alert alert-danger">'.concat(u,"</div>")),o.addClass("fa-check-circle").removeClass("fa-spinner fa-spin ");case 25:setTimeout((function(){n("#edit_modal .modal-body .alert").remove()}),4e3);case 26:case"end":return e.stop()}}),e,this,[[6,18]])})));return function(r){return e.apply(this,arguments)}}()),n("body").on("click","#extraction",(function(){window.open("/facture/reglements/extraction_reglement","_blank")})),n("body").on("click","#valider",function(){var a=s(regeneratorRuntime.mark((function a(t){var s,i,o;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.preventDefault(),r){a.next=4;break}return e.fire({icon:"error",title:"Veuillez selection une ligne!"}),a.abrupt("return");case 4:return(s=n("#valider i")).removeClass("fa-check").addClass("fa-spinner fa-spin"),a.prev=6,a.next=9,axios.get("/facture/reglements/getUgouvEncaissement/"+r);case 9:i=a.sent,response=i.data,n("body #encaissement_ugouv").html(response).select2(),n("#valider_modal").modal("show"),s.addClass("fa-check").removeClass("fa-spinner fa-spin "),a.next=21;break;case 16:a.prev=16,a.t0=a.catch(6),o=a.t0.response.data,e.fire({icon:"error",title:o}),s.addClass("fa-check").removeClass("fa-spinner fa-spin ");case 21:case"end":return a.stop()}}),a,null,[[6,16]])})));return function(e){return a.apply(this,arguments)}}()),n("body").on("submit",".valider_reglement-form",function(){var a=s(regeneratorRuntime.mark((function a(s){var i,o,l,c,u,d,m,f,p;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s.preventDefault(),i=n("body #encaissement_ugouv").find("option:selected"),console.log(i),o=i.data("montant"),l=i.data("code"),c=i.data("societe"),u=i.data("partner"),(d=new FormData(this)).append("montant",o),d.append("code",l),d.append("societe",c),d.append("partner",u),(m=n(".valider_reglement-form .btn i")).removeClass("fa-check-circle").addClass("fa-spinner fa-spin"),a.prev=14,a.next=17,axios.post("/facture/reglements/valider_reglement/"+r,d,{headers:{"Content-Type":"multipart/form-data"}});case 17:f=a.sent,f.data,n("#valider_modal").modal("hide"),e.fire({icon:"success",title:"Bien valider"}),m.addClass("fa-check-circle").removeClass("fa-spinner fa-spin"),r=!1,t.ajax.reload(null,!1),a.next=31;break;case 26:a.prev=26,a.t0=a.catch(14),p=a.t0.response.data,e.fire({icon:"error",title:p}),m.addClass("fa-check-circle").removeClass("fa-spinner fa-spin ");case 31:case"end":return a.stop()}}),a,this,[[14,26]])})));return function(e){return a.apply(this,arguments)}}())}))}},e=>{e.O(0,[9755,8029,620],(()=>{return r=9089,e(e.s=r);var r}));e.O()}]);