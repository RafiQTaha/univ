(self.webpackChunk=self.webpackChunk||[]).push([[4322],{2893:(e,a,r)=>{var t=r(9755);function n(e,a,r,t,n,s,o){try{var i=e[s](o),l=i.value}catch(e){return void r(e)}i.done?a(l):Promise.resolve(l).then(t,n)}function s(e){return function(){var a=this,r=arguments;return new Promise((function(t,s){var o=e.apply(a,r);function i(e){n(o,t,s,i,l,"next",e)}function l(e){n(o,t,s,i,l,"throw",e)}i(void 0)}))}}r(3076),r(4916),r(4765),r(9826),r(1539),r(2564),r(8674),t(document).ready((function(){var e=Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:function(e){e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),a=!1,r=t("#datables_facture").DataTable({lengthMenu:[[10,15,25,50,100,2e13],[10,15,25,50,100,"All"]],order:[[0,"desc"]],ajax:"/facture/factures/list",processing:!0,serverSide:!0,deferRender:!0,scrollX:!0,drawCallback:function(){t("body tr#"+a).addClass("active_databales")},preDrawCallback:function(e){t.fn.DataTable.isDataTable("#datables_facture")&&((e=t("#datables_facture").DataTable().settings())[0].jqXHR&&e[0].jqXHR.abort())},language:{url:"//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/French.json"}});t("select").select2(),t("#etablissement").on("change",s(regeneratorRuntime.mark((function e(){var a,n,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t(this).val(),r.columns(1).search(""),n="",""==a){e.next=13;break}return t("#reglement")&&""!=t("#reglement").val()&&r.columns(2).search(t("#reglement").val()),""!=t("#organisme").val()&&r.columns(3).search(t("#organisme").val()),r.columns(0).search(a).draw(),e.next=9,axios.get("/api/formation/"+a);case 9:s=e.sent,n=s.data,e.next=16;break;case 13:r.columns(0).search(a).draw(),t("#reglement")&&""!=t("#reglement").val()&&r.columns(2).search(t("#reglement").val()),""!=t("#organisme").val()&&r.columns(3).search(t("#organisme").val());case 16:t("#formation").html(n).select2();case 17:case"end":return e.stop()}}),e,this)})))),t("#formation").on("change",s(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t(this).val(),r.columns().search(""),t("#reglement")&&""!=t("#reglement").val()&&r.columns(2).search(t("#reglement").val()),""!=t("#organisme").val()&&r.columns(3).search(t("#organisme").val()),"",""==a){e.next=13;break}return r.columns(1).search(a).draw(),e.next=9,axios.get("/api/promotion/"+a);case 9:n=e.sent,n.data,e.next=14;break;case 13:r.columns(0).search(t("#etablissement").val()).draw();case 14:case"end":return e.stop()}}),e,this)})))),t("#reglement").on("change",s(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t(this).val(),r.columns(2).search(a).draw();case 2:case"end":return e.stop()}}),e,this)})))),t("#organisme").on("change",s(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t(this).val(),r.columns(3).search(a).draw();case 2:case"end":return e.stop()}}),e,this)}))));var n=!1,o=function(){axios.get("/facture/factures/getMontant/"+a).then((function(e){n=null,t("#ajouter").removeClass("btn-primary").addClass("btn-secondary").attr("disabled",!1),"vide"!=e.data&&(n=12,t("#montant_facture").val(e.data.montant_facture),t("#ajouter").removeClass("btn-secondary").addClass("btn-primary").attr("disabled",!0))})).catch((function(e){console.log(e)}))},i=function(){var e=t("#facture i");e.removeClass("fa-money-bill-alt").addClass("fa-spinner fa-spin"),axios.get("/facture/factures/detaille_facture/"+a).then((function(a){0==a.data[0]?(t(".modal-facture #add_detaille").css("display","none"),t(".modal-facture #add").css("display","none"),t(".modal-facture #detaille_active").css("display","none"),t(".modal-facture #delete_detaille").css("display","none")):(t(".modal-facture #add_detaille").css("display","block"),t(".modal-facture #add").css("display","flex"),t(".modal-facture #detaille_active").css("display","block"),t(".modal-facture #delete_detaille").css("display","block")),t(".table_detaille_facture tbody").html(a.data[1]),e.removeClass("fa-spinner fa-spin").addClass("fa-money-bill-alt")})).catch((function(e){console.log(e)}))};t("body").on("click","#datables_facture tbody tr",(function(e){e.preventDefault(),t(this).hasClass("active_databales")?(t(this).removeClass("active_databales"),a=null,n=null,t("#ajouter").removeClass("btn-primary").addClass("btn-secondary").attr("disabled",!1)):(t("#datables_facture tbody tr").removeClass("active_databales"),t(this).addClass("active_databales"),a=t(this).attr("id"),console.log(a),o(),i(),a&&axios.get("/facture/factures/article_frais/"+a).then((function(e){t("#detail_facture_modal #frais").html(e.data).select2(),t("#detail_facture_modal #montantt").val("")})).catch((function(e){console.log(e)})))})),t("body").on("click","#facture",(function(r){r.preventDefault(),a?t("#detail_facture_modal").modal("show"):e.fire({icon:"error",title:"Veuillez selection une ligne!"})})),t("input[type=radio][name=organ]").on("change",function(){var e=s(regeneratorRuntime.mark((function e(a){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),0!=this.value){e.next=10;break}return e.next=4,axios.get("/api/getorganismepasPayant");case 4:r=e.sent,response=r.data,t(".select-organ #org").html(response).select2(),t(".select-organ").css("display","block"),e.next=12;break;case 10:t(".select-organ #org").html(""),t(".select-organ").css("display","none");case 12:case"end":return e.stop()}}),e,this)})));return function(a){return e.apply(this,arguments)}}()),t("body").on("change",".modal-facture #frais",(function(e){e.preventDefault();var a=t(this).find(":selected").attr("data-id");""!=a&&t(".modal-facture #montantt").val(),t(".modal-facture #montantt").val(a)})),t("body").on("click","#add_detaille",function(){var e=s(regeneratorRuntime.mark((function e(n){var s,l,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),(s=t(this).find("i")).removeClass("fa-plus").addClass("fa-spinner fa-spin"),l=t(".select-organ #org").val(),1==t("input[name='organ']:checked").val()&&(l=7),(c=new FormData).append("frais",t("#frais").val()),c.append("montant",t("#montantt").val()),c.append("ice",t("#ice").val()),c.append("organisme_id",l),t(".modal-facture .modal-body .alert").remove(),e.prev=12,e.next=15,axios.post("/facture/factures/add_detaille/"+a,c);case 15:e.sent,i(),t(".modal-facture .modal-body").prepend('<div class="alert alert-success">Facture Bien Ajouter</div>'),t("select").val(""),s.removeClass("fa-spinner fa-spin").addClass("fa-plus"),o(),r.ajax.reload(null,!1),e.next=29;break;case 24:e.prev=24,e.t0=e.catch(12),u=e.t0.response.data,t(".modal-facture .modal-body").prepend('<div class="alert alert-danger">'.concat(u,"</div>")),s.removeClass("fa-spinner fa-spin").addClass("fa-plus");case 29:setTimeout((function(){t(".modal-facture .modal-body .alert").remove()}),4e3);case 30:case"end":return e.stop()}}),e,this,[[12,24]])})));return function(a){return e.apply(this,arguments)}}()),t("body").on("click","#delete_detaille",function(){var n=s(regeneratorRuntime.mark((function n(s){var l,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s.preventDefault(),1!=confirm("Vous voulez vraiment desactiver tout les frais ?")){n.next=20;break}return(l=t(this).find("i")).removeClass("fa-window-close").addClass("fa-spinner fa-spin"),n.prev=5,n.next=8,axios.post("/facture/factures/cloture_all_detaille/"+a);case 8:n.sent,o(),i(),r.ajax.reload(null,!1),l.removeClass("fa-spinner fa-spin").addClass("fa-window-close"),n.next=20;break;case 15:n.prev=15,n.t0=n.catch(5),c=n.t0.response.data,e.fire({icon:"error",title:c}),l.removeClass("fa-spinner fa-spin").addClass("fa-window-close");case 20:case"end":return n.stop()}}),n,this,[[5,15]])})));return function(e){return n.apply(this,arguments)}}()),t("body").on("click",".detaille_cloture",function(){var e=s(regeneratorRuntime.mark((function e(a){var n,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),(n=t(this).find("i")).removeClass("fa-window-close").addClass("fa-spinner fa-spin"),s=t(this).attr("id"),e.prev=4,e.next=7,axios.post("/facture/factures/cloture_detaille/"+s);case 7:e.sent,o(),i(),r.ajax.reload(null,!1),n.removeClass("fa-spinner fa-spin").addClass("fa-window-close"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),e.t0.response.data,n.removeClass("fa-spinner fa-spin").addClass("fa-window-close");case 18:case"end":return e.stop()}}),e,this,[[4,14]])})));return function(a){return e.apply(this,arguments)}}()),t("body").on("click","#ajouter",(function(r){r.preventDefault(),a?n?t("#ajouter_modal").modal("show"):e.fire({icon:"error",title:"Cette Facture N'a Aucun Detail!"}):e.fire({icon:"error",title:"Veuillez selection une ligne!"})})),t("body").on("submit",".new_facture-form",function(){var e=s(regeneratorRuntime.mark((function e(s){var i,l,c,u,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),i=t(this).serialize(),(l=t("#ajouter_modal .modal-body .alert")).remove(),(c=t(".new_facture-form .btn i")).removeClass("fa-check-circle").addClass("fa-spinner fa-spin"),t(".new_facture-form #save_reglement").addClass("disabled").attr("disabled",!0),e.prev=7,e.next=10,axios.post("/facture/factures/ajouter_reglement/"+a,i);case 10:u=e.sent,f=u.data,t("#ajouter_modal .modal-body").prepend('<div class="alert alert-success">Reglement Bien Ajouter</div>'),t(this).trigger("reset"),t(".new_facture-form select").val("").trigger("change"),o(),c.addClass("fa-check-circle").removeClass("fa-spinner fa-spin"),t(".new_facture-form #save_reglement").removeClass("disabled").attr("disabled",!1),n=!1,r.ajax.reload(null,!1),window.open("/facture/factures/facture/"+a+"/"+f,"_blank"),e.next=31;break;case 23:e.prev=23,e.t0=e.catch(7),d=e.t0.response.data,console.log(e.t0,e.t0.response),l.remove(),t("#ajouter_modal .modal-body").prepend('<div class="alert alert-danger">'.concat(d,"</div>")),c.addClass("fa-check-circle").removeClass("fa-spinner fa-spin "),t(".new_facture-form #save_reglement").removeClass("disabled").attr("disabled",!1);case 31:setTimeout((function(){t("#ajouter_modal .modal-body .alert").remove()}),4e3);case 32:case"end":return e.stop()}}),e,this,[[7,23]])})));return function(a){return e.apply(this,arguments)}}()),t("body").on("click","#imprimer",function(){var r=s(regeneratorRuntime.mark((function r(t){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.preventDefault(),a){r.next=4;break}return e.fire({icon:"error",title:"Veuillez selection une ligne!"}),r.abrupt("return");case 4:window.open("/facture/factures/printfacture/"+a,"_blank");case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()),t("body").on("click","#releve",function(){var r=s(regeneratorRuntime.mark((function r(t){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.preventDefault(),a){r.next=4;break}return e.fire({icon:"error",title:"Veuillez selection une ligne!"}),r.abrupt("return");case 4:window.open("/facture/factures/releve/"+a,"_blank");case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()),t("body").on("click","#extraction",(function(){window.open("/facture/factures/extraction_factures","_blank")})),t("body").on("click","#extra_frais",(function(e){e.preventDefault(),t("#annee_extraction_frais").modal("show")})),t("body").on("click","#export_frais",(function(e){e.preventDefault();var a=t("#annee").val();window.open("/facture/factures/extraction_factures_by_annee/"+a,"_blank")})),t("#valider").on("click",function(){var n=s(regeneratorRuntime.mark((function n(s){var o,l,c,u,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s.preventDefault(),a){n.next=4;break}return e.fire({icon:"error",title:"Veuillez selection une ligne!"}),n.abrupt("return");case 4:if((o=t("#valider i")).removeClass("fa-lock").addClass("fa-spinner fa-spin"),(l=new FormData).append("facture",a),1!=confirm("Vous voulez vraiment valider cette facture ?")){n.next=28;break}return n.prev=10,n.next=13,axios.post("/facture/factures/valider",l);case 13:c=n.sent,u=c.data,o.addClass("fa-lock").removeClass("fa-spinner fa-spin"),e.fire({icon:"success",title:u}),i(),a=!1,r.ajax.reload(null,!1),n.next=28;break;case 22:n.prev=22,n.t0=n.catch(10),console.log(n.t0),f=n.t0.response.data,o.addClass("fa-lock").removeClass("fa-spinner fa-spin"),e.fire({icon:"error",title:f});case 28:case"end":return n.stop()}}),n,null,[[10,22]])})));return function(e){return n.apply(this,arguments)}}()),t("#new_fac_organisme").on("click",function(){var n=s(regeneratorRuntime.mark((function n(s){var o,i,l,c,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s.preventDefault(),a){n.next=4;break}return e.fire({icon:"error",title:'Veuillez selection une Facture Inscription "Payant"!'}),n.abrupt("return");case 4:if((o=new FormData).append("facture",a),1!=confirm('Vous voulez vraiment Cree une facture "Organisme" ?')){n.next=27;break}return(i=t("#new_fac_organisme i")).removeClass("fa-file-invoice-dollar").addClass("fa-spinner fa-spin"),n.prev=10,n.next=13,axios.post("/facture/factures/new_fac_organisme",o);case 13:l=n.sent,c=l.data,i.addClass("fa-file-invoice-dollar").removeClass("fa-spinner fa-spin"),e.fire({icon:"success",title:c}),a=!1,r.ajax.reload(null,!1),n.next=27;break;case 21:n.prev=21,n.t0=n.catch(10),console.log(n.t0),u=n.t0.response.data,i.addClass("fa-file-invoice-dollar").removeClass("fa-spinner fa-spin"),e.fire({icon:"error",title:u});case 27:case"end":return n.stop()}}),n,null,[[10,21]])})));return function(e){return n.apply(this,arguments)}}()),t("#new_fac_payant").on("click",function(){var n=s(regeneratorRuntime.mark((function n(s){var o,i,l,c,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s.preventDefault(),a){n.next=4;break}return e.fire({icon:"error",title:'Veuillez selection une Facture Inscription Source "PYT"!'}),n.abrupt("return");case 4:if((o=new FormData).append("facture",a),1!=confirm('Vous voulez vraiment Cree une facture "Payant" ?')){n.next=27;break}return(i=t("#new_fac_payant i")).removeClass("fa-file-invoice-dollar").addClass("fa-spinner fa-spin"),n.prev=10,n.next=13,axios.post("/facture/factures/new_fac_payant",o);case 13:l=n.sent,c=l.data,i.addClass("fa-file-invoice-dollar").removeClass("fa-spinner fa-spin"),e.fire({icon:"success",title:c}),a=!1,r.ajax.reload(null,!1),n.next=27;break;case 21:n.prev=21,n.t0=n.catch(10),console.log(n.t0),u=n.t0.response.data,i.addClass("fa-file-invoice-dollar").removeClass("fa-spinner fa-spin"),e.fire({icon:"error",title:u});case 27:case"end":return n.stop()}}),n,null,[[10,21]])})));return function(e){return n.apply(this,arguments)}}())}))}},e=>{e.O(0,[9755,8029,6515],(()=>{return a=2893,e(e.s=a);var a}));e.O()}]);